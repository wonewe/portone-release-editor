<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>PortOne 문서 선택</title>
  <style>
    :root {
      --brand: #FC6B2D;
      --brand-dark: #d75520;
      --bg: #f3f4f6;
      --panel: #ffffff;
      --text: #111827;
      --muted: #6b7280;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Pretendard", "Noto Sans KR", sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
    }
    header {
      background: var(--brand);
      color: #ffffff;
      padding: 18px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .header-logo {
      height: 32px;
      width: auto;
      display: block;
    }
    .header-title {
      font-size: 15px;
      font-weight: 600;
    }
    main {
      flex: 1;
      width: 100%;
      max-width: 960px;
      padding: 48px 20px 64px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 32px;
    }
    .intro {
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .intro h1 {
      margin: 0;
      font-size: 32px;
      font-weight: 700;
      color: var(--text);
    }
    .intro p {
      margin: 0;
      font-size: 16px;
      color: var(--muted);
    }
    .grid {
      display: grid;
      gap: 18px;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
    .card {
      background: var(--panel);
      border-radius: 16px;
      border: 1px solid #e5e7eb;
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      box-shadow: 0 6px 16px rgba(252, 107, 45, 0.08);
    }
    .card h2 {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
    }
    .card p {
      margin: 0;
      font-size: 14px;
      line-height: 1.6;
      color: var(--muted);
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(252, 107, 45, 0.12);
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
      color: var(--brand-dark);
    }
    .card-actions {
      margin-top: auto;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .card-actions button {
      flex: 1 1 180px;
      padding: 10px 18px;
      border-radius: 12px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      background: var(--brand);
      color: #ffffff;
      transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }
    .card-actions button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(252, 107, 45, 0.25);
      background: var(--brand-dark);
    }
    .saved-section {
      margin-top: 48px;
      padding: 24px;
      background: var(--panel);
      border: 1px solid #e5e7eb;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(252, 107, 45, 0.05);
    }
    .saved-section h2 {
      margin: 0 0 16px;
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
    }
    .saved-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .saved-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 16px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      background: #ffffff;
    }
    .saved-item-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      flex: 1;
      min-width: 0;
    }
    .saved-item-meta {
      font-size: 12px;
      color: #6b7280;
      white-space: nowrap;
      margin-right: 12px;
    }
    .saved-item button {
      padding: 6px 12px;
      border-radius: 8px;
      border: none;
      background: var(--brand);
      color: #ffffff;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
    }
    .saved-item button:hover {
      background: var(--brand-dark);
    }
    .saved-item .delete-btn {
      background: #ef4444;
    }
    .saved-item .delete-btn:hover {
      background: #dc2626;
    }
    .saved-empty {
      font-size: 13px;
      color: var(--muted);
    }
    footer {
      padding: 24px 0 32px;
      text-align: center;
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <header>
    <div class="header-left">
      <img class="header-logo" src="/assets/portone-logo.png" alt="PortOne" />
      <div>
        <div class="header-title">PortOne 고객 문서 도우미</div>
        <div style="font-size:12px; opacity:0.85;">릴리즈노트 · 공지사항 · 템플릿 관리</div>
      </div>
    </div>
  </header>

  <main>
    <section class="intro" aria-label="문서 유형 안내">
      <h1>어떤 문서를 작성할까요?</h1>
      <p>작성하려는 문서 유형을 선택하면 맞춤형 편집기로 이동합니다.</p>
    </section>

    <section class="grid" aria-label="문서 유형 선택">
      <article class="card">
        <span class="pill">릴리즈 소식</span>
        <div>
          <h2>제품 릴리즈 노트</h2>
          <p>
            신규 기능이나 개선 사항을 파트너에게 안내할 때 사용합니다.
            제품군별 템플릿과 AI 초안 생성을 지원합니다.
          </p>
        </div>
        <div class="card-actions">
          <button type="button" data-document-type="release" data-product="payments">전자결제 릴리즈노트</button>
          <button type="button" data-document-type="release" data-product="finance">재무솔루션 릴리즈노트</button>
        </div>
      </article>

      <article class="card">
        <span class="pill">공지/안내</span>
        <div>
          <h2>서비스 공지 메일</h2>
          <p>
            점검 공지나 정책 변경 안내처럼 공식 커뮤니케이션이 필요할 때 활용하세요.
            심플한 레터 포맷과 CTA 버튼이 포함되어 있습니다.
          </p>
        </div>
        <div class="card-actions">
          <button type="button" data-document-type="notice">편집 시작하기</button>
        </div>
      </article>
    </section>

    <section class="saved-section" aria-label="저장된 문서 목록">
      <h2>저장된 문서</h2>
      <div id="savedDocsContainer" class="saved-list"></div>
    </section>
  </main>

  <footer>
    © 2025 PortOne Korea Corp. All rights reserved.
  </footer>

  <script>
    const STORAGE_KEY = 'portoneSavedDocs';

    document.querySelectorAll('button[data-document-type]').forEach((button) => {
      button.addEventListener('click', () => {
        const type = button.getAttribute('data-document-type') || 'release';
        const params = new URLSearchParams({ type });
        const product = button.getAttribute('data-product');
        if (product) params.set('product', product);
        window.location.href = `editor.html?${params.toString()}`;
      });
    });

    function loadSavedDocs() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        if (!Array.isArray(parsed)) return [];
        return parsed;
      } catch (error) {
        console.warn('Failed to parse saved docs', error);
        return [];
      }
    }

    function formatDate(iso) {
      if (!iso) return '';
      try {
        const date = new Date(iso);
        if (Number.isNaN(date.getTime())) return '';
        return date.toLocaleString('ko-KR', {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
        });
      } catch {
        return '';
      }
    }

    function renderSavedDocs() {
      const container = document.getElementById('savedDocsContainer');
      if (!container) return;
      const docs = loadSavedDocs().sort((a, b) => (b.updatedAt || '').localeCompare(a.updatedAt || ''));
      container.innerHTML = '';
      if (docs.length === 0) {
        const empty = document.createElement('p');
        empty.className = 'saved-empty';
        empty.textContent = '아직 저장된 문서가 없습니다. 편집기에서 저장하면 여기에서 확인할 수 있어요.';
        container.appendChild(empty);
        return;
      }

      docs.forEach((doc) => {
        const item = document.createElement('div');
        item.className = 'saved-item';

        const title = document.createElement('div');
        title.className = 'saved-item-title';
        title.textContent = doc.title || '제목 없음';

        const meta = document.createElement('div');
        meta.className = 'saved-item-meta';
        const timestamp = formatDate(doc.updatedAt);
        meta.textContent = timestamp ? timestamp : '';

        const openBtn = document.createElement('button');
        openBtn.type = 'button';
        openBtn.textContent = '열기';
        openBtn.addEventListener('click', () => {
          const params = new URLSearchParams({ saved: doc.id });
          if (doc.type) params.set('type', doc.type);
          if (doc.product) params.set('product', doc.product);
          window.location.href = `editor.html?${params.toString()}`;
        });

        const deleteBtn = document.createElement('button');
        deleteBtn.type = 'button';
        deleteBtn.className = 'delete-btn';
        deleteBtn.textContent = '삭제';
        deleteBtn.addEventListener('click', () => {
          const ok = window.confirm(`"${doc.title || '제목 없음'}" 문서를 삭제할까요?`);
          if (!ok) return;
          const next = loadSavedDocs().filter((itemDoc) => itemDoc.id !== doc.id);
          localStorage.setItem(STORAGE_KEY, JSON.stringify(next));
          renderSavedDocs();
        });

        item.appendChild(title);
        if (timestamp) item.appendChild(meta);
        item.appendChild(openBtn);
        item.appendChild(deleteBtn);
        container.appendChild(item);
      });
    }

    renderSavedDocs();
    window.addEventListener('portoneSavedDocsUpdated', renderSavedDocs);
  </script>
</body>
</html>
<script>
  window.addEventListener('portoneSavedDocsUpdated', renderSavedDocs);
</script>
